# ![–ü—Ä–∏–µ—Ö–∞–ª–∏ –†–∞–¥–∏ –ú–µ—Ä—á–∞: –æ—Ç—á–µ—Ç –æ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ](images/header.png)

## Web3

–í –∫–æ–¥–µ —Å–µ—Ä–≤–µ—Ä–∞ —Å—Ä–∞–∑—É –∑–∞–º–µ—Ç–Ω–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å SSTI –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ `/flag`. –û–¥–Ω–∞–∫–æ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–∏—Ç—å –∫ –Ω–µ–º—É –¥–æ—Å—Ç—É–ø –Ω–µ–ª—å–∑—è:  

![–∫–∞—Ä—Ç–∏–Ω–∫–∞](images/image9.png)

–í haproxy.cfg –≤–∏–¥–Ω–æ, —á—Ç–æ –ø—Ä–æ–∫—Å–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å `/flag`:

![–∫–∞—Ä—Ç–∏–Ω–∫–∞](images/image6.png)
  
–ü—Ä–æ–±—É–µ–º –æ–±–æ–π—Ç–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É, –¥–æ–±–∞–≤–∏–≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–ª–µ—à (`//flag`):
  
![–∫–∞—Ä—Ç–∏–Ω–∫–∞](images/image2.png)

–ü–æ–ª—É—á–∏–ª–æ—Å—å! –¢–µ–ø–µ—Ä—å –Ω–∞–¥–æ –æ–±–æ–π—Ç–∏ —Ñ–∏–ª—å—Ç—Ä –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å SSTI.

1. –§–∏–ª—å—Ç—Ä –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ (—Å–∫–æ–±–æ–∫ –∏ —Ç–¥) –Ω–µ —Ä–∞–±–æ—Ç–∞–ª, —Ç.–∫. –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Ä–µ–≥–µ–∫—Å `\w+`
2. –î–ª—è –æ–±—Ö–æ–¥–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –∫–æ–¥–æ–≤—ã—Ö —Å–ª–æ–≤ –Ω–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤–∏–¥–∞: `{...|attr(request.args.attribute)...&attribute=forbiden_keyword}`

![–∫–∞—Ä—Ç–∏–Ω–∫–∞](images/image5.png)

–ü–æ–ª—É—á–∏–≤ –¥–æ—Å—Ç—É–ø –∫ –æ–±—ä–µ–∫—Ç—É builtins, –º—ã —Å–º–æ–≥–ª–∏ —Å—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª —Å —Ñ–ª–∞–≥–æ–º `(...__globals__.builtins.open(‚Äúflag.txt‚Äù).read())`
  
![–∫–∞—Ä—Ç–∏–Ω–∫–∞](images/image11.png)

–ò—Ç–æ–≥–æ–≤—ã–π –ø–µ–π–ª–æ–∞–¥: `http://192.168.12.11:8001//flag?name={{%20(config|attr(request.args.c)).from_envvar.__globals__.__builtins__.open(%22flag.txt%22).read()%20}}&c=__class__`

## Crypto1

–í —ç—Ç–æ–π –∑–∞–¥–∞—á–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–ª–∞–≥–∞ –±—ã–ª–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–æ–±—Ä–∞—Ç—å –ø–∏–Ω-–∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º AES-CBC –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –î–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:

1. –í–µ–∫—Ç–æ—Ä –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (IV) 
2. –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
3. –ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

–ü—Ä–æ—á–∏—Ç–∞–≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∫–æ–¥ —Å–µ—Ä–≤–µ—Ä–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∞ —à–∏—Ñ—Ä–æ–≤–∫–∞, –º—ã –∑–∞–º–µ—Ç–∏–ª–∏, —á—Ç–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ IV –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ, –∞ —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è. 

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–Ω–æ–π —Ç—É—Ç –∞—Ç–∞–∫–µ:
https://stackoverflow.com/questions/3008139/why-is-using-a-non-random-iv-with-cbc-mode-a-vulnerability

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —à–∏—Ñ—Ä —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º IV (i_k):

![–∫–∞—Ä—Ç–∏–Ω–∫–∞](images/image4.png)

–ü–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â—É—é –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä:

1.  –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –ø–∏–Ω-–∫–æ–¥ `(p)`
2.  –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç IV –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ `(i_c)`
3.  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `xor(p, i_k, i_c)`

–ü–µ—Ä–µ–±–∏—Ä–∞–µ–º —Ü–∏–∫–ª–æ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–∏–Ω-–∫–æ–¥—ã, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∏—Ö —Ñ—É–Ω–∫—Ü–∏–µ–π –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –î–ª—è –≤–µ—Ä–Ω–æ–≥–æ –ø–∏–Ω-–∫–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ –≤—ã—à–µ.

–ü–æ–ª—É—á–∞–µ–º –ø–∏–Ω-–∫–æ–¥ 3561, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø–æ–ª—É—á–∞–µ–º —Ñ–ª–∞–≥.

*(–∫–æ–¥–∞ –Ω–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã –ø–∏—Å–∞–ª–∏ –µ–≥–æ –≤ REPL –ø–∏—Ç–æ–Ω–∞, –∏ –æ–Ω –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è, –Ω–∞–º —Å–∫–∞–∑–∞–ª–∏, —á—Ç–æ –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –æ–ø–∏—Å–∞—Ç—å —Å–ª–æ–≤–∞–º–∏ üôÇ)*

## Web1

–ù–∞–∂–∞–≤ –Ω–∞ —Å—Å—ã–ª–∫—É –≤ –≤–µ–± –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –≤–∏–¥–∏–º —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞

http://192.168.12.10:5001/download?file_type=file1.txt

–ü–æ–ª—å–∑—É–µ–º—Å—è —É—è–∑–≤–∏–º–æ—Å—Ç—å—é directory traversal –∏ –ø–æ–ª—É—á–∞–µ–º —Ñ–ª–∞–≥:

http://192.168.12.10:5001/download?file_type=../../etc/secret

## Web2

–î–ª—è –Ω–∞—á–∞–ª–∞ –¥–µ–∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º jar —Ñ–∞–π–ª. –í–∏–¥–∏–º –¥–∞–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é:
  
![–∫–∞—Ä—Ç–∏–Ω–∫–∞](images/image12.png)

–ó–∞–º–µ—á–∞–µ–º, —á—Ç–æ –µ—Å–ª–∏ —Å—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª password.txt –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è, –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `adminPassword` –±—É–¥–µ—Ç —Ä–∞–≤–Ω–∞ ‚Äúpassword‚Äù. –ó–Ω–∞—á–∏—Ç —Ñ–∞–π–ª –Ω–∞–¥–æ –∫–∞–∫–∏–º-—Ç–æ –æ–±—Ä–∞–∑–æ–º —É–¥–∞–ª–∏—Ç—å. –í —ç—Ç–æ–º –Ω–∞–º –ø–æ–º–æ–∂–µ—Ç —ç—Ç–æ—Ç –º–µ—Ç–æ–¥:

![–∫–∞—Ä—Ç–∏–Ω–∫–∞](images/image3.png)

Spring —Å—á–∏—Ç–∞–µ—Ç –≤–≤–µ–¥–µ–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä document —á–∞—Å—Ç—å—é –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ —à–∞–±–ª–æ–Ω–∞

![–∫–∞—Ä—Ç–∏–Ω–∫–∞](images/image10.png)

–ú—ã –º–æ–∂–µ–º –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —É—è–∑–≤–∏–º–æ—Å—Ç—å—é Spring View Manipulation —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ RCE –∏ —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª.

https://0xn3va.gitbook.io/cheat-sheets/framework/spring/view-manipulation

`http://192.168.12.13:8090/doc/__${T(java.lang.Runtime).getRuntime().exec("rm password.txt")}__::.x`

–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Å—Å—ã–ª–∫—É, –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –≤ login –ø–∞—Ä–∞–º–µ—Ç—Ä `password=password` –∏ –ø–æ–ª—É—á–∞–µ–º —Ñ–ª–∞–≥.

## –§–æ—Ä–µ–Ω–∑–∏–∫–∞ 1

–î–ª—è –Ω–∞—á–∞–ª–∞ –ø–æ–ø—ã—Ç–∞–µ–º—Å—è —É–∑–Ω–∞—Ç—å, –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–∞–∑–∏–ª—Å—è –≤–∏—Ä—É—Å–æ–º.

–°–∞–º—ã–π –æ—á–µ–≤–∏–¥–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç - –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞, –Ω–æ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∏–∫–∞–∫–∏—Ö –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–∞–π—Ç–æ–≤ –Ω–µ—Ç.

–í—Ç–æ—Ä–æ–π –≤–æ–∑–º–æ–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç - –∏–∑ –ø–æ—á—Ç—ã. –ù–µ–º–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞–≤, –Ω–∞—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫–µ AppData —Ñ–∞–π–ª –∏–∑ Microsoft Outlook - `company_worker123@rambler.ru.ost`

–û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª —á–µ—Ä–µ–∑ https://goldfynch.com –∏ —Å—Ä–∞–∑—É –≤–∏–¥–∏–º –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –ø–∏—Å—å–º–æ:

![–∫–∞—Ä—Ç–∏–Ω–∫–∞](images/image7.png)

–£ –Ω–∞—Å –µ—Å—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ 1 –≤–æ–ø—Ä–æ—Å - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–∞–∑–∏–ª—Å—è –≤–∏—Ä—É—Å–æ–º –∏–∑ –ø–∏—Å—å–º–∞. –î–∞–ª–µ–µ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –∞—Ä—Ö–∏–≤ –∏–∑ –ø–∏—Å—å–º–∞. –í–Ω—É—Ç—Ä–∏ –º—ã –≤–∏–¥–∏–º —Ñ–∞–π–ª TOP_SECRET.pdf –∏ –ø–∞–ø–∫—É —Å —Ç–∞–∫–∏–º –∂–µ –Ω–∞–∑–≤–∞–Ω–∏–µ–º, –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ñ–∞–π–ª ‚ÄúTOP_SECRET.pdf .cmd‚Äù. –≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å —É—è–∑–≤–∏–º–æ—Å—Ç—å –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ WinRar **(–æ—Ç–≤–µ—Ç –Ω–∞ 3 –≤–æ–ø—Ä–æ—Å)**. –°–º–æ—Ç—Ä–∏–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ cmd –∏ –ø–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å 2 - –≤–∏—Ä—É—Å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å –∞–¥—Ä–µ—Å–∞ 95.169.192.220:8080.
–ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–∞–π–ª –≤–∏—Ä—É—Å–∞ –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å —ç—Ç–∏–º –¥–µ–ª–∞–µ–º –¥–≤–µ –≤–µ—â–∏:

1.  –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞ —Ö–æ—Å—Ç–µ Wireshark
2.  –°–Ω–∏–º–∞–µ–º –¥–∞–º–ø –ø–∞–º—è—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ —á–µ—Ä–µ–∑ procdump

–í Wireshark –º—ã –≤–∏–¥–∏–º, —á—Ç–æ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –≤–∏—Ä—É—Å–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ api.telegram.org, –∑–Ω–∞—á–∏—Ç –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–µ–±–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç–∞ **(–≤–æ–ø—Ä–æ—Å 7)**.

–í–≤–æ–¥–∏–º `strings file.dmp`, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫–∏ –≤ –¥–∞–º–ø–µ –ø–∞–º—è—Ç–∏. –ù–∞—Ö–æ–¥–∏–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏:

1.  –ú–Ω–æ–≥–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π Rijndael –∏ CBC, –∑–Ω–∞—á–∏—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º AES-CBC **(–≤–æ–ø—Ä–æ—Å 5)**
2.  –°—Ç—Ä–æ–∫–∞ `amogusamogusamogusamogusamogusam` - 256 –±–∏—Ç, –≤–æ–∑–º–æ–∂–Ω—ã–π –∫–ª—é—á AES
3.  –†—è–¥–æ–º —Å –Ω–µ–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å—Ç—Ä–æ–∫–∞ `abababababababab` - 16 –±–∞–π—Ç, –≤–æ–∑–º–æ–∂–Ω—ã–π IV.

–ü—Ä–æ–±—É–µ–º —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –¥–∞–Ω–Ω–æ–π –ø–∞—Ä–æ–π IV –∏ –∫–ª—é—á–∞ –∏ –ø–æ–ª—É—á–∞–µ–º –ø–∞—Ä–æ–ª—å. **(–≤–æ–ø—Ä–æ—Å—ã 6, 8)**.

## –§–æ—Ä–µ–Ω–∑–∏–∫–∞ 2

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `serveradmin`. –ò–∑ —Ñ–∞–π–ª–æ–≤ –≤ –µ–≥–æ –¥–æ–º–∞—à–Ω–µ–π –ø–∞–ø–∫–µ –≤–∏–¥–Ω–æ, —á—Ç–æ –æ–Ω –Ω–∞—Ö–æ–¥–∏–ª—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ GitLab –≤–µ—Ä—Å–∏–∏ 15.2.2. –ì—É–≥–ª–∏–º –∏ –Ω–∞—Ö–æ–¥–∏–º, —á—Ç–æ –≤ —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏ GitLab –µ—Å—Ç—å RCE —É—è–∑–≤–∏–º–æ—Å—Ç—å, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –∏–º–ø–æ—Ä—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å –≥–∏—Ç—Ö–∞–±–∞ **(–≤–æ–ø—Ä–æ—Å—ã 1, 2)**.

https://github.com/m3ssap0/gitlab_rce_cve-2022-2884

–ù–æ GitLab —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è git, –∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É –Ω—É–∂–Ω–æ –±—ã–ª–æ –ø–æ–≤—ã—Å–∏—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏. –°–∫–∞–Ω–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É —á–µ—Ä–µ–∑ linpeas, –∏ –≤–∏–¥–∏–º —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏ –≤ /etc/sudoers:

![–∫–∞—Ä—Ç–∏–Ω–∫–∞](images/image1.png)

–ò–º–µ—è –¥–æ—Å—Ç—É–ø –∫ –∑–∞–ø—É—Å–∫—É –∫–æ–º–∞–Ω–¥—ã git –æ—Ç —Ä—É—Ç–∞, –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–≥ –ø–æ–≤—ã—Å–∏—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –∏ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ä—É—Ç –¥–æ—Å—Ç—É–ø **(–≤–æ–ø—Ä–æ—Å—ã 3, 4)**. –ü—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π:

```bash
sudo PAGER=‚Äôsh -c ‚Äúexec sh 0<&1‚Äù‚Äò git -p help
```

–¢–µ–ø–µ—Ä—å –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —Ö–∞–∫–µ—Ä –º–æ–≥ –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Ä—É—Ç –¥–æ—Å—Ç—É–ø. –¢–æ—Ç –∂–µ linpeas –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–º –≤–æ—Ç —Ç–∞–∫–æ–π –∫—É—Å–æ–∫ –∏–∑ —Ñ–∞–π–ª–∞ /etc/ssh/sshd_config **(–≤–æ–ø—Ä–æ—Å 3)**:

```
PermitRootLogin yes
```

–ü–æ–ª—É—á–∞–µ—Ç—Å—è, –∏–º–µ—è –¥–æ—Å—Ç—É–ø –∫ ssh –∫–ª—é—á–∞–º, —Ö–∞–∫–µ—Ä –º–æ–≥ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ ssh –æ—Ç —Ä—É—Ç–∞. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞–ø–∫—É /root/.ssh –∏ –≤–∏–¥–∏–º —Ñ–∞–π–ª authorized_keys:

![–∫–∞—Ä—Ç–∏–Ω–∫–∞](images/image8.png)

–ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –¥–æ–±–∞–≤–∏–ª —Å–≤–æ–π ssh –∫–ª—é—á –≤ —Å–ø–∏—Å–æ–∫ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π —Å–∏—Å—Ç–µ–º—ã –∏ –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ ssh —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏. **(–≤–æ–ø—Ä–æ—Å 5)**

–¢–∞–º –∂–µ –≤ –ø–∞–ø–∫–µ /root –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª .bash_history, –∏ –≤–∏–¥–∏–º –≤ –Ω–µ–º –∑–∞–ø–∏—Å—å

```bash
rm -rf /tmp/linpeas.txt
```

–ó–Ω–∞—á–∏—Ç, —Ö–∞–∫–µ—Ä –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–ª —Å–∏—Å—Ç–µ–º—É —á–µ—Ä–µ–∑ linpeas **(–æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å 7)**.

–û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç–∏—Ç—å, —Å –ø–æ–º–æ—â—å—é –∫–∞–∫–æ–≥–æ –ü–û –æ–Ω –∑–∞–∫—Ä–µ–ø–∏–ª—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ. –ü—Ä—è–º–æ –≤ –∫–æ—Ä–Ω–µ –æ–±—Ä–∞–∑–∞ –¥–∏—Å–∫–∞ –ª–µ–∂–∏—Ç –ø–∞–ø–∫–∞ XxJynx. –ü–æ–∏—Å–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –æ–Ω–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ä—É—Ç–∫–∏—Ç—É [JynxKit2](https://github.com/chokepoint/Jynx2), –∫–æ—Ç–æ—Ä—ã–π –∏ —É—Å—Ç–∞–Ω–æ–≤–∏–ª –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫, —á—Ç–æ–±—ã –∑–∞–∫—Ä–µ–ø–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–∏—Å—Ç–µ–º–æ–π **(–≤–æ–ø—Ä–æ—Å 8)**.
